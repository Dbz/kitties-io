<form id='signin-form' class='form-horizontal' method='post'>
	<input type='hidden' name='authenticity_token' value='<%= form_authenticity_token %>'>
	<div class='form-group'>
		<label for='username' class='col-sm-2 control-label'>Username</label>
		<div class='col-sm-10'>
			<input type='text' name='user[username]' id='username' class='form-control' place-holder='Enter Username'>
		</div>
	</div>
	<div class='form-group'>
		<label for='password' class='col-sm-2 control-label'>Password</label>
		<div class='col-sm-10'>
			<input type='password' name='user[password]' id='username' class='form-control' place-holder='Password'>
		</div>
	</div>
	<div class='auth-error'>
		<span class='invalid-combination'>Invalid Username/Password</span>
	</div>
	<button type='submit' class='btn btn-primary'>Log In!</button>
</form>

<script type="text/javascript">
	$(function () {
		$('#signin-form').on('submit', function (event) {
			event.preventDefault();
      $.ajax({
      	url: '/api/sessions',
				data: $(event.currentTarget).serialize(),
				type: "POST",
				success: function (data) {
					$('#auth-modal').modal('hide')
					window.Kitties.user = new Kitties.Models.User({ id: data.id });
					window.Kitties.cart.fetch();
				},
				error: function (resp) {
					if(~resp.responseJSON.indexOf("Invalid Username/Password"))
						$('.invalid-combination').show();
					$(event.currentTarget).on('submit', function() {
						$('.invalid-combination').hide();
					});
				},
      })
		})
	})
</script>